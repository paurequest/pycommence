<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>pycommence.wrapper.cmc_csr &mdash; Pycommence 0.1.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../../../_static/custom.css?v=e6a37869" />
      <link rel="stylesheet" type="text/css" href="../../../_static/dark_mode_css/general.css?v=c0a7eb24" />
      <link rel="stylesheet" type="text/css" href="../../../_static/dark_mode_css/dark.css?v=70edf1c7" />

  
    <link rel="canonical" href="https://pycommence.readthedocs.io/en/latest/_modules/pycommence/wrapper/cmc_csr.html" />
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../../_static/documentation_options.js?v=a58bc63e"></script>
        <script src="../../../_static/doctools.js?v=888ff710"></script>
        <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="../../../_static/dark_mode_js/default_dark.js?v=fd565c74"></script>
        <script src="../../../_static/dark_mode_js/theme_switcher.js?v=358d3910"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../index.html" class="icon icon-home">
            Pycommence
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../pycommence_api.html">Pycommence</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../pycommence_wrapper.html">Commence Wrapper</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">Pycommence</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../index.html">Module code</a></li>
          <li class="breadcrumb-item"><a href="../../pycommence.html">pycommence</a></li>
      <li class="breadcrumb-item active">pycommence.wrapper.cmc_csr</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for pycommence.wrapper.cmc_csr</h1><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">loguru</span> <span class="kn">import</span> <span class="n">logger</span>

<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">enums_cmc</span> <span class="k">as</span> <span class="n">cenum</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">rowset</span> <span class="k">as</span> <span class="n">rs</span>
<span class="kn">from</span> <span class="nn">._icommence</span> <span class="kn">import</span> <span class="n">ICommenceCursor</span>


<div class="viewcode-block" id="CsrCmc">
<a class="viewcode-back" href="../../../pycommence_wrapper.html#pycommence.wrapper.cmc_csr.CsrCmc">[docs]</a>
<span class="k">class</span> <span class="nc">CsrCmc</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Thin wrapper on the Commence Cursor object using pywin32.</span>

<span class="sd">    Create with :meth:`.cmc_db.Cmc.get_cursor`.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cmc_cursor</span><span class="p">:</span> <span class="n">ICommenceCursor</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Internal use only. Use :meth:`.cmc_db.Cmc.get_cursor` to create a cursor.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_csr_cmc</span> <span class="o">=</span> <span class="n">cmc_cursor</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s1">&#39;CmcCursor: &quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">category</span><span class="si">}</span><span class="s1">&quot;&#39;</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s1">&#39;CmcCursor: &quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">category</span><span class="si">}</span><span class="s1">&quot;&#39;</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">category</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_csr_cmc</span><span class="o">.</span><span class="n">Category</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">column_count</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_csr_cmc</span><span class="o">.</span><span class="n">ColumnCount</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">row_count</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_csr_cmc</span><span class="o">.</span><span class="n">RowCount</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">shared</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_csr_cmc</span><span class="o">.</span><span class="n">Shared</span>

<div class="viewcode-block" id="CsrCmc.set_filter">
<a class="viewcode-back" href="../../../pycommence_wrapper.html#pycommence.wrapper.cmc_csr.CsrCmc.set_filter">[docs]</a>
    <span class="k">def</span> <span class="nf">set_filter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filter_text</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Defines a filter clause for the cursor.</span>

<span class="sd">        Args:</span>
<span class="sd">            filter_text (str): Text defining the new filter clause. Syntax is identical to the one used by the DDE ViewFilter request.</span>

<span class="sd">        Raises:</span>
<span class="sd">            CmcError on fail</span>

<span class="sd">        Returns:</span>
<span class="sd">            bool: True on success.</span>

<span class="sd">        If the cursor is opened in CURSOR_VIEW mode, the set_filter only affects the cursor&#39;s secondary filter.</span>
<span class="sd">        That is, when building the rowset, the view&#39;s filter is first evaluated.</span>
<span class="sd">        Items that match are then passed through the cursor&#39;s secondary filter.</span>
<span class="sd">        The rowset only contains items that satisfy both filters.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_csr_cmc</span><span class="o">.</span><span class="n">SetFilter</span><span class="p">(</span><span class="n">filter_text</span><span class="p">,</span> <span class="n">cenum</span><span class="o">.</span><span class="n">FLAGS_UNUSED</span><span class="p">)</span></div>


<div class="viewcode-block" id="CsrCmc.set_filter_logic">
<a class="viewcode-back" href="../../../pycommence_wrapper.html#pycommence.wrapper.cmc_csr.CsrCmc.set_filter_logic">[docs]</a>
    <span class="k">def</span> <span class="nf">set_filter_logic</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">logic_text</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Defines the filter logic for the cursor.</span>

<span class="sd">        Args:</span>
<span class="sd">            logic_text (str): Text defining the new filter logic. Syntax is identical to the one used by the DDE ViewConjunction request.</span>


<span class="sd">        Unless otherwise specified, the default logic is AND, AND, AND.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Setting filter logic to </span><span class="si">{</span><span class="n">logic_text</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_csr_cmc</span><span class="o">.</span><span class="n">SetLogic</span><span class="p">(</span><span class="n">logic_text</span><span class="p">,</span> <span class="n">cenum</span><span class="o">.</span><span class="n">FLAGS_UNUSED</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">res</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Unable to set filter logic to </span><span class="si">{</span><span class="n">logic_text</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Unable to set filter logic&#39;</span><span class="p">)</span></div>


<div class="viewcode-block" id="CsrCmc.set_sort">
<a class="viewcode-back" href="../../../pycommence_wrapper.html#pycommence.wrapper.cmc_csr.CsrCmc.set_sort">[docs]</a>
    <span class="k">def</span> <span class="nf">set_sort</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sort_text</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Defines the sort criteria for the cursor.</span>

<span class="sd">        Args:</span>
<span class="sd">            sort_text (str): Text defining the new sort criteria. Syntax is identical to the one used by the DDE ViewSort request.</span>


<span class="sd">        If the cursor is opened in CMC_CURSOR_VIEW mode, the sort defaults to the view&#39;s sort.</span>
<span class="sd">        All other cursor modes default to ascending sort by the Name field.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Setting sort to </span><span class="si">{</span><span class="n">sort_text</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_csr_cmc</span><span class="o">.</span><span class="n">SetSort</span><span class="p">(</span><span class="n">sort_text</span><span class="p">,</span> <span class="n">cenum</span><span class="o">.</span><span class="n">FLAGS_UNUSED</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">res</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Unable to set sort to </span><span class="si">{</span><span class="n">sort_text</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Unable to sort&#39;</span><span class="p">)</span></div>


<div class="viewcode-block" id="CsrCmc.set_column">
<a class="viewcode-back" href="../../../pycommence_wrapper.html#pycommence.wrapper.cmc_csr.CsrCmc.set_column">[docs]</a>
    <span class="k">def</span> <span class="nf">set_column</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">column_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">field_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
            <span class="n">flags</span><span class="p">:</span> <span class="n">cenum</span><span class="o">.</span><span class="n">OptionFlag</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">cenum</span><span class="o">.</span><span class="n">OptionFlag</span><span class="o">.</span><span class="n">NONE</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Defines the column set for the cursor.</span>

<span class="sd">        Args:</span>
<span class="sd">            column_index (int): The (0-based) index of the column to set.</span>
<span class="sd">            field_name (str): Name of the field to use in this column.</span>
<span class="sd">            flags (int): Option flags (Logical OR of option flags like CMC_FLAG_ALL to create column set of all fields).</span>

<span class="sd">        Returns:</span>
<span class="sd">            bool: True on success, False on error.</span>

<span class="sd">        When defining a column set, the columns must be defined in sequential order (0, 1, 2, etc.).</span>
<span class="sd">        This is to prevent problems with undefined columns (e.g. 0, 1, 3, ...).</span>
<span class="sd">        Duplicate columns are not supported. Each column must map to a different field.</span>
<span class="sd">        Not all Commence field types can be included in the cursor definition.</span>
<span class="sd">        The set of supported field types exactly matches those fields that can be displayed in a Commence report</span>
<span class="sd">        (minus combined fields and indirect fields).</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Setting column </span><span class="si">{</span><span class="n">column_index</span><span class="si">}</span><span class="s1"> to </span><span class="si">{</span><span class="n">field_name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_csr_cmc</span><span class="o">.</span><span class="n">SetColumn</span><span class="p">(</span><span class="n">column_index</span><span class="p">,</span> <span class="n">field_name</span><span class="p">,</span> <span class="n">flags</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">res</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Unable to set column&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">res</span></div>


<div class="viewcode-block" id="CsrCmc.seek_row">
<a class="viewcode-back" href="../../../pycommence_wrapper.html#pycommence.wrapper.cmc_csr.CsrCmc.seek_row">[docs]</a>
    <span class="k">def</span> <span class="nf">seek_row</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">start</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">rows</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Seek to a particular row in the cursor.</span>

<span class="sd">        Args:</span>
<span class="sd">            start (int): Position to move from. Can be one of the following:</span>
<span class="sd">                - 0 (BOOKMARK_BEGINNING) - from first row</span>
<span class="sd">                - 1 (BOOKMARK_CURRENT) - from current row</span>
<span class="sd">                - 2 (BOOKMARK_END) - from last row</span>

<span class="sd">            rows (int): Number of rows to move the current row pointer.</span>

<span class="sd">        Returns:</span>
<span class="sd">            int: Number of rows moved.</span>

<span class="sd">        Raises:</span>
<span class="sd">            CmcError on fail</span>

<span class="sd">        For any cursor, there is a &#39;current row pointer&#39;.</span>
<span class="sd">        When the cursor is created, this defaults to the first row.</span>
<span class="sd">        SeekRow will reposition the current row pointer.</span>
<span class="sd">        GetQueryRowSet, GetEditRowSet, and GetDeleteRowSet will also advance the current row pointer.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_csr_cmc</span><span class="o">.</span><span class="n">SeekRow</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">rows</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">res</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Unable to seek </span><span class="si">{</span><span class="n">rows</span><span class="si">}</span><span class="s1"> rows&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">res</span></div>


<div class="viewcode-block" id="CsrCmc.seek_row_fractional">
<a class="viewcode-back" href="../../../pycommence_wrapper.html#pycommence.wrapper.cmc_csr.CsrCmc.seek_row_fractional">[docs]</a>
    <span class="k">def</span> <span class="nf">seek_row_fractional</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">numerator</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">denominator</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Seek to a fractional position in the cursor.</span>

<span class="sd">        Args:</span>
<span class="sd">            numerator (int): Numerator for fractional position in the cursor.</span>
<span class="sd">            denominator (int): Denominator for the fractional position in the cursor.</span>

<span class="sd">        Returns:</span>
<span class="sd">            int: Actual number of rows moved, -1 on error.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_csr_cmc</span><span class="o">.</span><span class="n">SeekRowApprox</span><span class="p">(</span><span class="n">numerator</span><span class="p">,</span> <span class="n">denominator</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">res</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s1">&#39;Unable to seek </span><span class="si">{</span><span class="n">numerator</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">denominator</span><span class="si">}</span><span class="s1"> rows of </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">row_count</span><span class="si">}</span><span class="s1"> rows&#39;</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="n">res</span></div>


<div class="viewcode-block" id="CsrCmc.get_query_row_set">
<a class="viewcode-back" href="../../../pycommence_wrapper.html#pycommence.wrapper.cmc_csr.CsrCmc.get_query_row_set">[docs]</a>
    <span class="k">def</span> <span class="nf">get_query_row_set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">count</span><span class="p">:</span> <span class="nb">int</span> <span class="ow">or</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">rs</span><span class="o">.</span><span class="n">RowSetQuery</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create a rowset object with the results of a query.</span>

<span class="sd">        Args:</span>
<span class="sd">            count (int): Maximum number of rows to retrieve.</span>

<span class="sd">        Returns:</span>
<span class="sd">            RowSetQuery: Pointer to rowset object on success, None on error.</span>

<span class="sd">        The rowset inherits the column set from the cursor.</span>
<span class="sd">        The cursor&#39;s &#39;current row pointer&#39; determines the first row to be included in the rowset.</span>
<span class="sd">        The returned rowset can have fewer than count rows (e.g. if the current row pointer is near the end).</span>
<span class="sd">        Use CommenceXRowSet.row_count to determine the actual row count.</span>
<span class="sd">        GetQueryRowSet will advance the &#39;current row pointer&#39; by the number of rows in the rowset.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">count</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">count</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">row_count</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_csr_cmc</span><span class="o">.</span><span class="n">GetQueryRowSet</span><span class="p">(</span><span class="n">count</span><span class="p">,</span> <span class="n">cenum</span><span class="o">.</span><span class="n">FLAGS_UNUSED</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">result</span><span class="o">.</span><span class="n">rowcount</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;No rows found.&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">rs</span><span class="o">.</span><span class="n">RowSetQuery</span><span class="p">(</span><span class="n">result</span><span class="p">)</span></div>


<div class="viewcode-block" id="CsrCmc.get_query_row_set_by_id">
<a class="viewcode-back" href="../../../pycommence_wrapper.html#pycommence.wrapper.cmc_csr.CsrCmc.get_query_row_set_by_id">[docs]</a>
    <span class="k">def</span> <span class="nf">get_query_row_set_by_id</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">row_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Args:</span>
<span class="sd">            row_id:str Unique ID string obtained from GetRowID().</span>

<span class="sd">        Returns:</span>
<span class="sd">            Pointer to rowset object on success, NULL on error.</span>

<span class="sd">        The rowset inherits column set from the cursor.</span>
<span class="sd">        The cursor&#39;s &#39;current row pointer&#39; is not advanced.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">rs</span><span class="o">.</span><span class="n">RowSetQuery</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_csr_cmc</span><span class="o">.</span><span class="n">GetQueryRowSetByID</span><span class="p">(</span><span class="n">row_id</span><span class="p">,</span> <span class="n">cenum</span><span class="o">.</span><span class="n">FLAGS_UNUSED</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">res</span><span class="o">.</span><span class="n">row_count</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">res</span></div>


<div class="viewcode-block" id="CsrCmc.get_add_row_set">
<a class="viewcode-back" href="../../../pycommence_wrapper.html#pycommence.wrapper.cmc_csr.CsrCmc.get_add_row_set">[docs]</a>
    <span class="k">def</span> <span class="nf">get_add_row_set</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">count</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
            <span class="n">flags</span><span class="p">:</span> <span class="n">cenum</span><span class="o">.</span><span class="n">OptionFlag</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">cenum</span><span class="o">.</span><span class="n">OptionFlag</span><span class="o">.</span><span class="n">SHARED</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">rs</span><span class="o">.</span><span class="n">RowSetAdd</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a rowset of new items to add to the database.</span>

<span class="sd">        Args:</span>
<span class="sd">            count (int): The number of rows to create.</span>
<span class="sd">            flags (int): Option flags. Use CMC_FLAG_SHARED to default all rows to shared.</span>

<span class="sd">        Returns:</span>
<span class="sd">            RowSetAdd: A rowset object for adding new items.</span>

<span class="sd">        The rowset inherits the column set from the cursor.</span>
<span class="sd">        When first created, each row is initialized to field default values.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">count</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">count</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">row_count</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">rs</span><span class="o">.</span><span class="n">RowSetAdd</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_csr_cmc</span><span class="o">.</span><span class="n">GetAddRowSet</span><span class="p">(</span><span class="n">count</span><span class="p">,</span> <span class="n">flags</span><span class="o">.</span><span class="n">value</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">res</span><span class="o">.</span><span class="n">row_count</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">res</span></div>


<div class="viewcode-block" id="CsrCmc.get_edit_row_set">
<a class="viewcode-back" href="../../../pycommence_wrapper.html#pycommence.wrapper.cmc_csr.CsrCmc.get_edit_row_set">[docs]</a>
    <span class="k">def</span> <span class="nf">get_edit_row_set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">count</span><span class="p">:</span> <span class="nb">int</span> <span class="ow">or</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">rs</span><span class="o">.</span><span class="n">RowSetEdit</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a rowset of existing items for editing.</span>

<span class="sd">        Args:</span>
<span class="sd">            count (int): The number of rows to retrieve, defaults to all rows in csr.</span>

<span class="sd">        Returns:</span>
<span class="sd">            RowSetEdit: A rowset object for editing existing items, or None on error.</span>

<span class="sd">        The rowset inherits the column set from the cursor.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">count</span> <span class="o">=</span> <span class="n">count</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">row_count</span>
        <span class="k">return</span> <span class="n">rs</span><span class="o">.</span><span class="n">RowSetEdit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_csr_cmc</span><span class="o">.</span><span class="n">GetEditRowSet</span><span class="p">(</span><span class="n">count</span><span class="p">,</span> <span class="n">cenum</span><span class="o">.</span><span class="n">FLAGS_UNUSED</span><span class="p">))</span></div>


<div class="viewcode-block" id="CsrCmc.get_edit_row_set_by_id">
<a class="viewcode-back" href="../../../pycommence_wrapper.html#pycommence.wrapper.cmc_csr.CsrCmc.get_edit_row_set_by_id">[docs]</a>
    <span class="k">def</span> <span class="nf">get_edit_row_set_by_id</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">row_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">rs</span><span class="o">.</span><span class="n">RowSetEdit</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a rowset for editing a particular row.</span>

<span class="sd">        Args:</span>
<span class="sd">            row_id (str): Unique ID string obtained from GetRowID().</span>

<span class="sd">        Returns:</span>
<span class="sd">            RowSetEdit: A rowset object for editing a particular row, or None on error.</span>

<span class="sd">        The rowset inherits the column set from the cursor.</span>
<span class="sd">        The cursor&#39;s &#39;current row pointer&#39; is not advanced.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">rs</span><span class="o">.</span><span class="n">RowSetEdit</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_csr_cmc</span><span class="o">.</span><span class="n">GetEditRowSetByID</span><span class="p">(</span>
                <span class="n">row_id</span><span class="p">,</span>
                <span class="n">cenum</span><span class="o">.</span><span class="n">FLAGS_UNUSED</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">res</span><span class="o">.</span><span class="n">row_count</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">res</span></div>


<div class="viewcode-block" id="CsrCmc.get_delete_row_set">
<a class="viewcode-back" href="../../../pycommence_wrapper.html#pycommence.wrapper.cmc_csr.CsrCmc.get_delete_row_set">[docs]</a>
    <span class="k">def</span> <span class="nf">get_delete_row_set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">count</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">rs</span><span class="o">.</span><span class="n">RowSetDelete</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a rowset of existing items for deletion.</span>

<span class="sd">        Args:</span>
<span class="sd">            count (int): The number of rows to retrieve.</span>

<span class="sd">        Returns:</span>
<span class="sd">            RowSetDelete: A rowset object for deleting existing items, or None on error.</span>

<span class="sd">        The rowset inherits the column set from the cursor.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">delset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_csr_cmc</span><span class="o">.</span><span class="n">GetDeleteRowSet</span><span class="p">(</span><span class="n">count</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">rs</span><span class="o">.</span><span class="n">RowSetDelete</span><span class="p">(</span><span class="n">delset</span><span class="p">)</span></div>


<div class="viewcode-block" id="CsrCmc.get_delete_row_set_by_id">
<a class="viewcode-back" href="../../../pycommence_wrapper.html#pycommence.wrapper.cmc_csr.CsrCmc.get_delete_row_set_by_id">[docs]</a>
    <span class="k">def</span> <span class="nf">get_delete_row_set_by_id</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">row_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
            <span class="n">flags</span><span class="p">:</span> <span class="n">cenum</span><span class="o">.</span><span class="n">OptionFlag</span> <span class="o">=</span> <span class="n">cenum</span><span class="o">.</span><span class="n">OptionFlag</span><span class="o">.</span><span class="n">NONE</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">rs</span><span class="o">.</span><span class="n">RowSetDelete</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a rowset for deleting a particular row.</span>

<span class="sd">        Args:</span>
<span class="sd">            row_id (str): Unique ID string obtained from GetRowID().</span>
<span class="sd">            flags (int, optional): Unused at present, must be 0. Defaults to 0.</span>

<span class="sd">        Returns:</span>
<span class="sd">            RowSetDelete: A rowset object for deleting a particular row</span>

<span class="sd">        The rowset inherits the column set from the cursor.</span>
<span class="sd">        The cursor&#39;s &#39;current row pointer&#39; is not advanced.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">rs</span><span class="o">.</span><span class="n">RowSetDelete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_csr_cmc</span><span class="o">.</span><span class="n">GetDeleteRowSetByID</span><span class="p">(</span><span class="n">row_id</span><span class="p">,</span> <span class="n">flags</span><span class="o">.</span><span class="n">value</span><span class="p">))</span></div>


<div class="viewcode-block" id="CsrCmc.set_active_item">
<a class="viewcode-back" href="../../../pycommence_wrapper.html#pycommence.wrapper.cmc_csr.CsrCmc.set_active_item">[docs]</a>
    <span class="k">def</span> <span class="nf">set_active_item</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">category</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">row_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set active item used for view cursors using a view linking filter_str.</span>

<span class="sd">        Args:</span>
<span class="sd">            category (str): Category name of the active item used with view linking filter_str.</span>
<span class="sd">            row_id (str): Unique ID string obtained from GetRowID()</span>

<span class="sd">        Returns:</span>
<span class="sd">            bool: True on success, else False on error.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_csr_cmc</span><span class="o">.</span><span class="n">SetActiveItem</span><span class="p">(</span><span class="n">category</span><span class="p">,</span> <span class="n">row_id</span><span class="p">,</span> <span class="n">cenum</span><span class="o">.</span><span class="n">FLAGS_UNUSED</span><span class="p">)</span></div>


<div class="viewcode-block" id="CsrCmc.set_active_date">
<a class="viewcode-back" href="../../../pycommence_wrapper.html#pycommence.wrapper.cmc_csr.CsrCmc.set_active_date">[docs]</a>
    <span class="k">def</span> <span class="nf">set_active_date</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">active_date</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set active active_date used for view cursors using a view linking filter_str.</span>

<span class="sd">        Args:</span>
<span class="sd">            active_date (str): Date value used with view linking filter_str supports active_date values such as &#39;today&#39;.</span>

<span class="sd">        Returns:</span>
<span class="sd">            bool: True on success, else False on error.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_csr_cmc</span><span class="o">.</span><span class="n">SetActiveDate</span><span class="p">(</span><span class="n">active_date</span><span class="p">,</span> <span class="n">cenum</span><span class="o">.</span><span class="n">FLAGS_UNUSED</span><span class="p">)</span></div>


<div class="viewcode-block" id="CsrCmc.set_active_date_range">
<a class="viewcode-back" href="../../../pycommence_wrapper.html#pycommence.wrapper.cmc_csr.CsrCmc.set_active_date_range">[docs]</a>
    <span class="k">def</span> <span class="nf">set_active_date_range</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">start</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">end</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set active active_date range used for view cursors using a view linking filter_str.</span>

<span class="sd">        Args:</span>
<span class="sd">            start (str): Date value of start active_date used with view linking filter_str Supports natural language values such as &#39;today&#39;.</span>
<span class="sd">            end (str): Date value of end active_date used with view linking filter_str. Supports natural language values such as &#39;next monday&#39;.</span>

<span class="sd">        Returns:</span>
<span class="sd">            bool: True on success, else False on error.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_csr_cmc</span><span class="o">.</span><span class="n">SetActiveDateRange</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">cenum</span><span class="o">.</span><span class="n">FLAGS_UNUSED</span><span class="p">)</span></div>


<div class="viewcode-block" id="CsrCmc.set_related_column">
<a class="viewcode-back" href="../../../pycommence_wrapper.html#pycommence.wrapper.cmc_csr.CsrCmc.set_related_column">[docs]</a>
    <span class="k">def</span> <span class="nf">set_related_column</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">col</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
            <span class="n">con_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
            <span class="n">connected_cat</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
            <span class="n">col_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
            <span class="n">flags</span><span class="p">:</span> <span class="n">cenum</span><span class="o">.</span><span class="n">OptionFlag</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">cenum</span><span class="o">.</span><span class="n">OptionFlag</span><span class="o">.</span><span class="n">NONE</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Adds a related (indirect/connected field) column to the cursor.</span>

<span class="sd">        Args:</span>
<span class="sd">            col (int): The (0-based) index of the column to set.</span>
<span class="sd">            con_name (str): Name of the connection to use in this column.</span>
<span class="sd">            connected_cat (str): Name of the connected Category to use in this column.</span>
<span class="sd">            col_name (str): Name of the field in the connected Category to use in this column.</span>
<span class="sd">            flags (int): Option flags (Logical OR of option flags like CMC_FLAG_ALL to create column set of all fields).</span>

<span class="sd">        Returns:</span>
<span class="sd">            bool: True on success, False on error.</span>

<span class="sd">        Example:</span>
<span class="sd">            set_related_column(0, &quot;Relates To&quot;, &quot;History&quot;, &quot;Date&quot;, 0)</span>
<span class="sd">            This call will add the Date field to the cursor via the &#39;Relates to History&#39; connection.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_csr_cmc</span><span class="o">.</span><span class="n">SetRelatedColumn</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="n">con_name</span><span class="p">,</span> <span class="n">connected_cat</span><span class="p">,</span> <span class="n">col_name</span><span class="p">,</span> <span class="n">flags</span><span class="o">.</span><span class="n">value</span><span class="p">)</span></div>
</div>

</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, PawRequest.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>